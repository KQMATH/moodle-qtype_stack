define(["jquery","qtype_stack/validation-overlay"],function(t,i){"use strict";var n=function(t,i,n,e,a){this.questionid=t,this.prefix=i,this.inputs=n,this.editorOptions=e,this.debug=a,this.stackInputs={},this.validationOverlays={},this.readonly=null,this.editorVisible=null,this._initValidation(),this._gatherStackInputs()};return n.prototype.EDITOR_NAME="GENERIC",n.prototype._initValidation=function(){for(var n=0;n<this.inputs.length;n++){var e=this.inputs[n].input,a=t("#"+t.escapeSelector(this.prefix+e)+"_val");if(a){var s=new i(a);this.validationOverlays[e]=s}}},n.prototype._gatherStackInputs=function(){for(var i=0;i<this.inputs.length;i++){var n=this.inputs[i].input,e=t("#"+t.escapeSelector(this.prefix+n));e&&(this.stackInputs[n]=e)}},n.prototype.isReadonly=function(){var t=this.readonly;if(null!=t)return t;var i=!0,n=this;return Object.keys(this.stackInputs).forEach(function(t){n.stackInputs[t].prop("readonly")&&(i=!1)}),t=!i},n.prototype.inputError=function(t,i){var n=this.getValidationOverlay(t);n&&n.displayErrorMessage(i)},n.prototype.getStackInput=function(t){return this.stackInputs[t]},n.prototype.valueChanged=function(t,i){var n=this.getValidationOverlay(t);n&&n.hide();var e=this.getStackInput(t);e.val(i),e.get(0).dispatchEvent(new Event("input")),""===i&&this.getValidationOverlay(t).getUnderlay().addClass("empty")},n.prototype.getValidationOverlay=function(t){return this.validationOverlays[t]},n});